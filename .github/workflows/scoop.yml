name: Scoop
on:
  push:
    paths:
      - '.github/workflows/scoop.yml'
      - 'windows/scoop/**'

env:
  SCOOP: 'C:\bin'

defaults:
  run:
    shell: powershell
    working-directory: windows/scoop

jobs:
  vscode:
    name: Install Scoop and packages
    runs-on: windows-latest
    strategy:
      matrix:
        bundle: ['bn-dev', 'bn-ops', 'bn-common']
    steps:
      - name: Checkout sources
        uses: actions/checkout@v3

      - name: Install Scoop
        run: iex "& {$(irm get.scoop.sh)} -RunAsAdmin"

      - name: Install packages
        env:
          PATH: '${{ env.PATH }};C:\bin\shims'
        run: |
          .\bin\import.ps1 ${{ matrix.bundle }}
          scoop bucket list
          scoop list
